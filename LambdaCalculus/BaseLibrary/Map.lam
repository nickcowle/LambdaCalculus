empty := λ leaf λ branch . leaf

node := λ left λ k λ v λ right λ leaf λ branch . branch left k v right

insert := Combinators.Y (λ insert λ cmp λ k λ v λ m . m (Map.node Map.empty k v Map.empty) (λ l λ k1 λ v1 λ r . cmp k k1 (Map.node (insert cmp k v l) k1 v1 r) (Map.node l k1 v r) (Map.node l k1 v1 (insert cmp k v r))))

find := Combinators.Y (λ find λ cmp λ k λ m . m Option.none (λ l λ k1 λ v1 λ r . cmp k k1 (find cmp k l) (Option.some v1) (find cmp k r)))